<!DOCTYPE html>
<html>
  <head>
    <meta charset='UTF-8' />
    <title data-bind='text: title'></title>
    <link href='css/application.css' rel='stylesheet' type='text/css' />
    <link href='css/styles.css' rel='stylesheet' type='text/css' />
    <link href='css/doremi.css' rel='stylesheet' type='text/css' />
  </head>
  <body data-bind='event: {resize: composition_handle_resize}'>
    <div class='liveExample'>
      <div class='controls'>
        <button data-bind='click: toggle_composition_select_visible'>
          Open locally saved
        </button>
        <select data-bind="visible: composition_select_visible, options: compositions_in_local_storage, optionsText: 'title', value: selected_composition,click: composition_select" size='4'></select>
        <button data-bind='click: save_locally, enable: saveable'>
          Save locally
        </button>
        <button data-bind='click: new_composition'>
          New Composition
        </button>
        <button data-bind='click: print_composition'>
          Print
        </button>
        <button data-bind='css: {button_on:open_file_visible},click: toggle_open_file_visible'>
          Open File
        </button>
        <div class='open_file_div' data-bind='visible:open_file_visible'>
          <label>Open:</label>
          <input id='file' name='files[]' type='file' />
        </div>
        <a href='http://github.com/rothfield/doremi-script-gui'>
          Documentation/github home page
        </a>
      </div>
      <fieldset class='controls' id='composition_info'>
        <legend data-bind='click: toggle_composition_info_visible' id='composition_info_legend'>
          <span data-bind='text: title'></span>
          (Click to hide/show composition info such as title and key)
        </legend>
        <div data-bind='visible: composition_info_visible' id='composition_info_content' style=''>
          <p>
            <label>
              Title:
            </label>
            <input data-bind='value: title' id='composition_title' />
            <span class='required'>
              Required
            </span>
          </p>
          <p>
            <label>
              Author:
            </label>
            <input data-bind='value: author' />
          </p>
          <p>
            <label>
              Key:
            </label>
            <select data-bind='options: keys, value: key'></select>
          </p>
          <p>
            <label>
              Mode:
            </label>
            <select data-bind='options: modes, value: mode'></select>
          </p>
          <p>
            <label>
              Time Signature:
            </label>
            <input data-bind='value: time_signature' />
          </p>
          <p>
            <label>
              Source:
            </label>
            <input data-bind='value: source' />
          </p>
          <p>
            <label>
              Raga:
            </label>
            <input data-bind='value: raga' />
          </p>
          <p>
            <label>
              ID#:
            </label>
            <span data-bind='text: id'></span>
          </p>
          <div>
            <button data-bind='css: {button_on:doremi_script_source_visible},click: toggle_doremi_script_source_visible'>
              DoremiScript Source
            </button>
            <button data-bind='visible: doremi_script_source_visible,click: refresh_doremi_script_source'>
              Refresh
            </button>
            <div class='doremi_script_source_div like_pre' data-bind='text: doremi_script_source,visible: doremi_script_source_visible,event:{dblclick:toggle_doremi_script_source_visible}'></div>
          </div>
          <div>
            <button data-bind='css: {button_on:parsed_doremi_script_visible},click: toggle_parsed_doremi_script_visible'>
              Parsed DoremiScript
            </button>
            <button data-bind='visible: parsed_doremi_script_visible,click: refresh_parsed_doremi_script'>
              Refresh
            </button>
            <div class='parsed_doremi_script_div like_pre' data-bind='text: composition_parsed_doremi_script,visible: parsed_doremi_script_visible,event:{dblclick:toggle_parsed_doremi_script_visible}'></div>
          </div>
          <div>
            <button data-bind='css: {button_on:composition_lilypond_source_visible},click: toggle_composition_lilypond_source_visible'>
              Lilypond source
            </button>
            <button data-bind='visible: composition_lilypond_source_visible,click: refresh_composition_lilypond_source'>
              Refresh
            </button>
            <div class='composition_lilypond_source_div like_pre' data-bind='visible: composition_lilypond_source_visible,text: composition_lilypond_source,event:{dblclick:toggle_composition_lilypond_source_visible}'></div>
          </div>
          <div>
            <button data-bind='css: {button_on:composition_musicxml_source_visible},click: toggle_composition_musicxml_source_visible'>
              MusicXML Source
            </button>
            <button data-bind='visible: composition_musicxml_source_visible,click: refresh_composition_musicxml_source'>
              Refresh
            </button>
            <div class='composition_musicxml_source_div like_pre' data-bind='visible: composition_musicxml_source_visible,text: composition_musicxml_source,event:{dblclick:toggle_composition_musicxml_source_visible}'></div>
          </div>
        </div>
      </fieldset>
      <br />
      <div class='composition'>
        <div class='controls'>
          <div class='composition_controls'>
            <button data-bind='disable: disable_generate_staff_notation,click: generate_staff_notation'>
              Generate staff notation
            </button>
            <button data-bind='css: {button_on:staff_notation_visible},click: toggle_staff_notation_visible'>
              Show Staff Notation
            </button>
          </div>
          <img alt='spinner' class='spinner' data-bind='visible: generating_staff_notation' src='images/musical-notes-animated.gif' width='50' />
        </div>
        <div class='staff_notation_div' data-bind='visible: staff_notation_visible'>
          <img alt='staff notation' class='staff_notation' data-bind='attr: {src:staff_notation_url_with_time_stamp}' src='images/none.jpg' />
        </div>
        <br />
        <br />
        <div class='composition_body' data-bind='foreach: lines'>
          <div class='line_wrapper' data-bind='attr: { id: line_wrapper_id()},click: line_wrapper_click ' tabindex='0'>
            <div class='rendered_html' data-bind='visible: !editing(),html: rendered_in_html, click: edit,clickBubble:false'></div>
            <div class='edit_line_wrapper' data-bind='visible:editing,css: {line_has_warnings: line_has_warnings,line_parse_failed: line_parse_failed}'>
              <button data-bind='click: close_edit,clickBubble:false'>
                Close
              </button>
              <button data-bind='click: $parent.composition_insert_line,clickBubble:false'>
                Insert
              </button>
              <button data-bind='click: $parent.composition_append_line,clickBubble:false'>
                Append
              </button>
              <button data-bind='click: toggle_line_warnings_visible,clickBubble:false'>
                Warnings
              </button>
              <button class='toggle_line_parse_tree' data-bind='css: {button_on:parse_tree_visible},click: toggle_parse_tree_visible'>
                Show/Hide Parse Tree
              </button>
              <br />
              <div class='line_warnings_div' data-bind='visible: line_warnings_visible'>
                <pre data-bind='text: line_warnings,event:{dblclick:toggle_line_warnings_visible}'></pre>
              </div>
              <div class='parse_tree_div' data-bind='visible: parse_tree_visible'>
                <pre data-bind='text: parse_tree_text,event:{dblclick:toggle_parse_tree_visible}'></pre>
              </div>
              <textarea class='entry_area' cols='33' data-bind="style: {height:stave_height,width: $parent.composition_stave_width},css: {'line_has_warnings': $data.line_has_warnings,'parse_failed': $data.parse_failed},visible: editing(), value: source, event: { keypress: handle_key_press, blur: handle_blur}, valueUpdate: 'afterkeydown'" rows='3' spellcheck='false'></textarea>
            </div>
          </div>
        </div>
      </div>
      <br />
      <br />
      <button class='controls' data-bind="click: add_line, enable: title() !=='' ">New Line</button>
    </div>
    <span class="note testing_utf_support" id="utf_left_repeat" style="display: none; ">&#x1d106;</span>
    <span id="utf_single_barline" class="note testing_utf_support" style="display: none; ">&#x1d100;</span>
    <script src='js/knockout-2.0.0.debug.js' type='text/javascript'></script>
    <script src='js/doremi-script/third_party/jquery.js' type='text/javascript'></script>
    <script src='js/doremi-script/third_party/jquery.autogrow-textarea.js' type='text/javascript'></script>
    <script src='js/doremi-script/third_party/underscore.js' type='text/javascript'></script>
    <script src='js/doremi-script/underscore.logger.js' type='text/javascript'></script>
    <script src='js/doremi-script/shims.js' type='text/javascript'></script>
    <script src='js/doremi-script/all_items.js' type='text/javascript'></script>
    <script src='js/doremi-script/shared.js' type='text/javascript'></script>
    <script src='js/doremi-script/third_party/fraction.js' type='text/javascript'></script>
    <script type="text/javascript">
    <!-- / Hack part 1- to make Hypher.js work in the browser. -->
    window.module= {exports:[]}
    </script>
    <script src='js/doremi-script/third_party/hypher/hypher.js' type='text/javascript'></script>
    <script src='js/doremi-script/third_party/hyphenation_patterns/en-us.js' type='text/javascript'></script>
    <script type="text/javascript">
    <!-- / Hack part 2 to make Hypher.js work in the browser -->
    window.module=undefined;
    </script>
    <script src='js/doremi-script/tree_iterators.js' type='text/javascript'></script>
    <script src='js/doremi-script/parser_helper.js' type='text/javascript'></script>
    <script src='js/doremi-script/to_lilypond.js' type='text/javascript'></script>
    <script src='js/doremi-script/to_musicxml.js' type='text/javascript'></script>
    <script src='js/doremi-script/doremi_script_parser.js' type='text/javascript'></script>
    <script src='js/doremi-script/doremi_script_line_parser.js' type='text/javascript'></script>
    <script src='js/doremi-script/dom_fixer.js' type='text/javascript'></script>
    <script src='js/doremi-script/html_renderer.js' type='text/javascript'></script>
    <!-- stash css and javascript here when necessary to generate a standalone page. -->
    <script id='css_for_html_doc' type='text/html'></script>
    <script id='zepto_for_html_doc' type='text/html'></script>
    <script id='dom_fixer_for_html_doc' type='text/html'></script>
    <script id='testing_utf_support' type='text/html'></script>
    <script src='js/application.js' type='text/javascript'></script>
  </body>
</html>
