<!DOCTYPE html>
<html>
  <head>
    <title>Test Knockout</title>
    <link href='/css/application.css' rel='stylesheet' type='text/css' />
    <link href='/css/styles.css' rel='stylesheet' type='text/css' />
    <link href='/css/doremi.css' rel='stylesheet' type='text/css' />
  </head>
  <body>
    <div class='liveExample'>
      <p>
        Locally saved compositions:
        <select data-bind="options: availableCountries, optionsText: 'countryName', value: selectedCountry, optionsCaption: 'Open'"></select>
      </p>
      <fieldset id='composition_info'>
        <legend data-bind='click: toggle_composition_info_visibility' id='composition_info_legend'>
          Composition Info(Click to hide/show)
        </legend>
        <div data-bind='visible: composition_info_visible' id='composition_info_content'>
          <p>
            Raga:
            <input data-bind='value: raga' />
          </p>
          <p>
            Key:
            <select data-bind='options: keys, value: key'></select>
          </p>
          <p>
            Mode:
            <select data-bind='options: modes, value: mode'></select>
          </p>
          <p>
            Title:
            <input data-bind='value: title' />
          </p>
          <p>
            Author:
            <input data-bind='value: author' />
          </p>
          <p>
            Source:
            <input data-bind='value: source' />
          </p>
          <p>
            Time Signature:
            <input data-bind='value: time_signature' />
          </p>
          <p>
            ID#:
            <span data-bind='text: id'></span>
          </p>
        </div>
      </fieldset>
      <h2>Composition Lines</h2>
      <div id='linesList'>
        <table class='linesEditor'>
          <tbody data-bind='foreach: lines'>
            <tr class='line_header'>
              <th>
                <input data-bind='checked: edit_mode, attr: { name: radio_group_name(), id: source_radio_id}' type='radio' value='source'>
                  <label data-bind='attr: { for: source_radio_id}'>
                    Source
                  </label>
                </input>
                <input data-bind='checked: edit_mode,  attr: { name: radio_group_name(), id: html_radio_id}' name='edit_mode_group' type='radio' value='html'>
                  <label data-bind='attr: { for: html_radio_id}'>
                    Html
                  </label>
                </input>
                <a data-bind='click: show_parse_tree_click' href='#'>
                  Show/Hide Parse Tree
                </a>
              </th>
              <th></th>
            </tr>
            <tr>
              <td>
                <textarea class='entry_area' cols='33' data-bind="css: {'parse_failed': $data.parse_failed},visible: edit_mode() == 'source', value: source, event: { keypress: handle_key_press}, valueUpdate: 'afterkeydown'" rows='3'></textarea>
                <div class='rendered_doremi_script' data-bind="visible: edit_mode() == 'html', html: rendered_in_html"></div>
                <div class='parse_tree_div' data-bind='visible: parse_tree_visible'>
                  <pre class='parse_tree' data-bind='text: parse_tree_text'>Parse tree here</pre>
                </div>
                <div id='warnings_div'></div>
              </td>
              <td>
                <div>
                  <a data-bind='click: $root.removeLine' href='#'>Delete</a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <p>
        <button data-bind='click: addLine'>New Line</button>
        <button data-bind='click: save, enable: lines().length &gt; 0'>Save to JSON</button>
        <button data-bind='click: save_locally, enable: lines().length &gt; 0'>Save locally</button>
      </p>
      <textarea cols='60' data-bind='value: lastSavedJson' disabled='disabled' rows='5'></textarea>
    </div>
    <script src='/js/jquery.js' type='text/javascript'></script>
    <script src='/js/knockout-2.0.0.debug.js' type='text/javascript'></script>
    <script src='/js/doremi-script/third_party/jquery.js' type='text/javascript'></script>
    <script src='/js/doremi-script/third_party/jquery.autogrow-textarea.js' type='text/javascript'></script>
    <script src='/js/doremi-script/third_party/underscore.js' type='text/javascript'></script>
    <script src='/js/doremi-script/underscore.logger.js' type='text/javascript'></script>
    <script src='/js/doremi-script/shims.js' type='text/javascript'></script>
    <script src='/js/doremi-script/all_items.js' type='text/javascript'></script>
    <script src='/js/doremi-script/shared.js' type='text/javascript'></script>
    <script src='/js/doremi-script/third_party/fraction.js' type='text/javascript'></script>
    <script src='/js/doremi-script/tree_iterators.js' type='text/javascript'></script>
    <script src='/js/doremi-script/parser_helper.js' type='text/javascript'></script>
    <script src='/js/doremi-script/to_lilypond.js' type='text/javascript'></script>
    <script src='/js/doremi-script/to_musicxml.js' type='text/javascript'></script>
    <script src='/js/doremi-script/doremi_script_parser.js' type='text/javascript'></script>
    <script src='/js/doremi-script/doremi_script_line_parser.js' type='text/javascript'></script>
    <script src='/js/doremi-script/dom_fixer.js' type='text/javascript'></script>
    <script src='/js/doremi-script/html_renderer.js' type='text/javascript'></script>
    <!-- stash css and javascript here when necessary to generate a standalone page. -->
    <script id='css_for_html_doc' type='text/html'></script>
    <script id='zepto_for_html_doc' type='text/html'></script>
    <script id='dom_fixer_for_html_doc' type='text/html'></script>
    <script id='testing_utf_support' type='text/html'></script>
    <script src='/js/application.js' type='text/javascript'></script>
  </body>
</html>
